<script type="text/javascript">
    var startDate = new Date(REPORT_CONFIG.first_entry);
    var endPeriod = new Date();
    endPeriod.setDate(endPeriod.getDate() - 15);
    var startPeriod = new Date(endPeriod.getFullYear(), endPeriod.getMonth() - 2, endPeriod.getDate());

    var periodReportViewConfig = {
        id : "period_report",
        date: {
            start: startPeriod,
            end: endPeriod,
        },
        cumulativeFlowChart: {
            id: 'period_report_extract_cumulative_chart',
            height: 600
        },
        durationStats: 'period_report_duration_stats',
        filter: "period_report_switch"
    };

    var periodReportDashboard = new ReportDashboard(periodReportViewConfig);

    //Initialisation du Date Range Picker
    $(function() {
        $('input[name="daterange"]').daterangepicker({
            startDate: startPeriod.formatDDMMYYYY(),
            endDate: endPeriod.formatDDMMYYYY(),
            minDate: startDate.formatDDMMYYYY(),
            locale: {
                format: 'DD/MM/YYYY'
            }
        }, function(start, end, label) {
            periodReportDashboard.resetDates(start.toDate(), end.toDate());
        });
    });

    registerDashboard("#tab_period_report_view", periodReportDashboard);
</script>

<div class="card to-print graph">
    <div class="row">
        <h2 class="col-md-12 card-title">
            <img class="print-only" src="../../img/team-traffic.png"/> Team Traffic - Cycle time -
            <input type="text" name="daterange" value="01/01/2015 - 01/31/2015" />
            <span id="period_report_title_suffix"></span>
            <div class="not-to-print pull-right">
                <div id="period_report_switch" class="switch"></div>
                <a href="#"><span class="glyphicon glyphicon-th-list" data-toggle="modal" data-target="#period_report_tasks_list_modal"></span></a>
            </div>
        </h2>
    </div>
    <div class="row card-relative-chart">
        <div id="period_report_extract_cumulative_chart"></div>
        <div class="card to-print stats">
            <div id="period_report_duration_stats"></div>
        </div>
    </div>
</div>

<div id="period_report_tasks_list_modal" class="modal ticket-list fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Tasks list</h4>
            </div>
            <div class="modal-body">
                <div id="period_report_tasks_list" class="col-md-12"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

